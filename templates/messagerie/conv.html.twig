{% extends 'template.html.twig' %}
{% block title %}Messagerie - SecureChat
{% endblock %}
{% block body %}
	<!-- Sidebar -->
	<!-- Chat content -->
		<div class="main" id="chat-dialog"> <div class="tab-content" id="nav-tabContent">
			{% if messages|length > 0 %}
				<!-- Start of Fill Chat -->
				<div
					class="babble tab-pane fade active show">
					<!-- Start of Chat -->
					<div
						class="chat" id="chat1">
						<!-- Start Chat Header -->
						<div class="top">
							<div class="container">
								<div class="col-md-12">
									<div class="inside">
										<div class="data">
											<h5>
												<strong>{{'Groupe : ' ~ currentGroupe.name}}</strong>
												({% set i = 0 %}
												{% for u in currentUsersGroupe %}
													{% if u == user %}
														<a href="#">{{ "Vous" }}</a>
													{% else %}
														<a href="#">{{ u.username }}</a>
													{% endif %}
													{% if i > 1 or i < currentUsersGroupe|length - 1 %}
														{{", "}}
													{% endif %}
													{% set i = i + 1 %}
												{% endfor %})
											</h5>
										</div>
										<div class="dropdown">
											<button class="btn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
												<i class="ti-view-grid"></i>
											</button>
											<div class="dropdown-menu dropdown-menu-right">
												<a href="#" class="dropdown-item">
													<i class="ti-hand-stop"></i>Ajouter un membre</a>
												<a href="#" class="dropdown-item">
													<i class="ti-trash"></i>Kick un membre</a>
											</div>
										</div>
										<button class="btn back-to-mesg" title="Back">
											<i class="ti-arrow-right"></i>
										</button>
									</div>
								</div>
							</div>
						</div>
						<!-- End Chat header -->
						<!-- Start Chat Body -->
						<div class="content" id="content">
							<div class="container">
								<div
									class="col-md-12">
									<!--div class="date">
																																														<hr>
																																														<span>Yesterday</span>
																																														<hr>
																																													</div-->
									{% for m in messages %}
										{% if m.user.id != user.id %}
											<div class="message">
												<img class="avatar-md" src="{{asset('dist/img/avatars/' ~ m.user.picture)}}" data-toggle="tooltip" data-placement="top" title="Karen joye" alt="avatar">
												<div class="text-main">
													<div class="text-group">
														<div class="text">
															<p>{{m.content}}</p>
														</div>
													</div>
													<span>{{m.date|date("M jS \\a\\t G\\hi")}}</span>
												</div>
											</div>
										{% else %}
											<div class="message me">
												<div class="text-main">
													<div class="text-group me">
														<div class="text me">
															<p>{{m.content}}</p>
														</div>
													</div>
													<span>{{m.date|date("M jS \\a\\t G\\hi")}}</span>
												</div>
											</div>
										{% endif %}
									{% endfor %}
									<!-- Entrain d'écrire -->
									{# <div class="message">
																											<img class="avatar-md" src="dist/img/avatars/avatar-female-5.jpg" data-toggle="tooltip" data-placement="top" title="Karen joye" alt="avatar">
																											<div class="text-main">
																											<div class="text-group">
																												<div class="text typing">
																													<div class="wave">
																														<span class="dot"></span>
																														<span class="dot"></span>
																														<span class="dot"></span>
																													</div>
																												</div>
																											</div>
																											</div>
																											</div> #}
								</div>
							</div>
						</div>
						<!-- End Chat Body-->
						<!-- Start Write Box -->
						<div class="container">
							<div class="col-md-12">
								<div
									class="bottom">
									<!-- Start Form Message -->
									{{ form_start(sendMessage, {'attr' : {'class':'text-area'}}) }}
									{{ form_widget(sendMessage.content) }}
									<div class="add-smiles">
										<span title="add icon" class="em em-blush"></span>
									</div>
									<button type="submit" class="btn send">
										<i class="ti-location-arrow"></i>
									</button>
									{{ form_end(sendMessage) }}
									<!-- End Form Message -->
								</div>
							</div>
						</div>
						<!-- End Write Box -->
					</div>
					<!-- End of Chat -->
				</div>
				<!-- End of Fill Chat -->
			{% elseif messages|length < 1  %}
				<!-- Start of Empty Chat -->
				<div
					class="babble tab-pane fade active show">
					<!-- Start of Chat -->
					<div class="chat" id="chat">
						<div class="top">
							<div class="container">
								<div class="col-md-12">
									<div class="inside">
										<div class="status offline"></div>
										<div class="data">
											<h5>
												<a href="#">Bob Frank</a>
											</h5>
										</div>
										<div class="dropdown">
											<button class="btn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
												<i class="ti-view-grid"></i>
											</button>
											<div class="dropdown-menu dropdown-menu-right">
												<a href="#" class="dropdown-item">
													<i class="ti-headphone-alt"></i>Ajouter un utilisateur</a>
												<a href="#" class="dropdown-item">
													<i class="ti-trash"></i>Retirer une personne</a>
											</div>
										</div>
										<button class="btn back-to-mesg" title="Back">
											<i class="ti-arrow-right"></i>
										</button>
									</div>
								</div>
							</div>
						</div>
						<div class="content empty">
							<div class="container">
								<div class="col-md-12">
									<div class="no-messages">
										<i class="ti-comments"></i>
										<p>Aucuns méssages n'a été envoyés pour le moment. Soit le premier à briser la glace !</p>
									</div>
								</div>
							</div>
						</div>
						<div class="container">
							<div class="col-md-12">
								<div
									class="bottom">
									<!-- Start Form Message -->

									{{ form_start(sendMessage, {'attr' : {'class':'text-area'}}) }}
									{{ form_widget(sendMessage.content) }}
									<div class="add-smiles">
										<span title="add icon" class="em em-blush"></span>
									</div>
									<button type="submit" class="btn send">
										<i class="ti-location-arrow"></i>
									</button>
									{{ form_end(sendMessage) }}
									<!-- End Form Message -->
								</div>
							</div>
						</div>
					</div>
					<!-- End of Chat -->
				</div>
				<!-- End of Empty Chat -->
			</div>
		{% endif %}
	</div>
{% endblock %}